# 2022 - Week 3

## Procedure parsing pixels

Much of week 3 was spent gently coaxing our [procedure parsing code](https://parliamentary-procedures.herokuapp.com/meta/comments) to spit out some pixels. The code, as it stands, declares procedural business [steps](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e175) in a [work package](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e222) to be either [actualised](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e364) or unactualised. Taking this as a starting point, it then traverses the [routes](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e164) between steps and - by means of [logical](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/#logic-steps) and [arithmetic](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/#arithmetic-steps) operators - declares each route to be either TRUE, FALSE, [ALLOWS](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/#decision-steps) or [UNTRAVERSABLE](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/#route-currentness-and-untraversability). Taking this knowledge, once a route meets another business step, it declares the [future potential state](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/#potential-states-of-a-business-step) of that step to be either caused to happen, precluded from happening, allowed to happen or currently off limits. All of which gets [rendered as a series of lists](https://parliamentary-procedures.herokuapp.com/work-packages/4). If - and we recognise this is unlikely - you'd like to know more, you really should read our [design notes](https://ukparliament.github.io/ontologies/procedure/maps/meta/design-notes/). I mean, somebody should. We've slaved over them.

Whilst the list rendering suits some of our purposes, we'd long intended to replicate the visualisations that team:[Samu](https://twitter.com/langsamu) made for the old style, more basic route-type based maps. So this week, we [added new code](https://github.com/ukparliament/procedure-parsing/blob/master/app/views/work_package/visualise.html.erb) to generate a [DOT file](https://en.wikipedia.org/wiki/DOT_(graph_description_language)) per parsed work package, piped that into [D3](https://en.wikipedia.org/wiki/D3.js) which very kindly rendered an SVG of blobs and arrows, then decorated that with [a splash of CSS](https://github.com/ukparliament/procedure-parsing/blob/master/app/views/layouts/application.html.erb#L18). Why CSS designed to [decorate an SVG](https://www.w3.org/TR/SVG11/styling.html) uses completely different language to CSS designed to decorate HTML remains a mystery to us. Though if there's one thing we're always doing, it's learning.

The [results so far](https://parliamentary-procedures.herokuapp.com/work-packages/4/parse/visualise) are somewhere between impressive and incomprehensible. Business steps marked actualised have a white background, those marked unactualised have a grey background. Routes marked as TRUE are solid blue, routes marked as ALLOWS are dotted blue, routes marked as FALSE are solid red and routes marked as UNTRAVERSABLE are dotted red. By extension of the same logic, steps which are caused to happen have a solid blue border, steps allows to happen have a dotted blue border, steps precluded from happening yet have a solid red border and steps that are currently off limits have a dotted red border. At least that's true at the time of writing. By the time you read this it may well have changed. Young Robert has taken over the map making reins, which is handy because not only is he skilled at information design, he's also trained to do it. He also has the ability to see colours, which is not amongst [Michael](https://twitter.com/fantasticlife)'s many advantages in life.

The pixels, as they stand, have already proved their worth in helping us to better understand and patch up both [procedure maps](https://ukparliament.github.io/ontologies/procedure/maps/) and parsing code. Without maps, all debugging had been a matter of working one's way up the [parse dump](https://parliamentary-procedures.herokuapp.com/work-packages/4/parse), trying to figure out where things had gone wrong. With the maps, working eyes and working fingers, it's much, much easier to trace the parse tree and find faults. Though even with visualisations, Michael still managed to spend three hours trying to fix our parsing code, only to find he'd [typed 'SUMMATION' and not 'Summation'](https://trello.com/c/ttAzXcrB/251-why-are-some-routes-unparsed-argh). Proving that even with tools available, you can't fix stupid.

Whilst Librarian Jayne and Michael might find our new maps handy, they are rather more complicated than the maps our crack team of librarians had grown used to. Which led to Friday finding Jayne, young Robert and Michael head down in CSS and pixels attempting to simplify matters. Not, it must be said, with much success. Removing a step in CSS does not remove the routes into it - obviously you might say - so we end up with more split ends than poodle permed rocker. Whether we'll have more luck tinkering with the dot file generation than the CSS remains a job for next week.

It should, perhaps, be pointed out that the procedure parsing pixels do not, as yet, take account of Michael's festive season efforts to [apply plausibility scores to steps declared as allowed to happen](https://ukparliament.github.io/ontologies/meta/weeknotes/2022/02/#parsing-the-political-from-the-procedural). This is partly because he's since noticed at least one step is returning [a plausibility score in excess of 100%](https://trello.com/c/pP1All05/253-why-are-some-steps-reporting-100-plausibility). Which we think might suggest an error in his sums. And partly because JO Jane pointed out that figures for steps taking place in the House of Lords should really be based on instruments that have ever been in the House of Lords. Rather than all of them. A good catch from JO Jane there. Whilst the rest of you might be developing an addiction to Wordle, Michael's weekend puzzle setting comes via JO Jane's admirable pedantry and some blasted SQL. Fun.

## Procedural planning

If half of the week was spent tidying the loose ends arising from our switch to logical and arithmetic procedure maps, the other half was spent planning for the future. It is, after all, a new year, so what better time to make resolutions we'll struggle to keep. Over the course of the last week, our regular reader may have noticed a few changes to our beloved [procedure model](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html). In short order, these are:

* A new class used to declare the [display depth of a step in a procedure](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e289). The need for this arises from the fact that, whilst we store dates on [business items](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e211), we do not store times. When a work package sees lots of business items happening on the same day - an occurrence often occasioned by things both Brexit and Corona related - the website doesn't know which order to display them in. Which means we often see steps describing the conclusion of a procedure before we see the passing of an approval motion. Capturing the display depth, should, we hope, fix this.

* New classes around [step collections](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e255) and [step collection memberships](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e244). A whole bunch of use cases around grouping steps has arisen over the past year, from suppressing some steps from website display to assigning steps to bill stages to declaring steps to be starting steps to declaring steps to be concluding steps. And so on. And so forth. We hope that some combination of display depth and step collections will help make the website rather less cluttered and our code rather less hard-coded.

* A new class for [legislature](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e322) has been added, allowing us to both [group our Houses](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e470) into one UK Parliament and to [declare steps around legislative consent motions to have happened in one of the devolved legislatures](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e455).

* A new class of [route availability](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e300) has been added to better cope with changes in legislation, standing orders and orders of the Houses. The model we currently have allows for a route to be closed and reopened but only ever once. Should a standing order be suspended, then reinstated, then rescinded, we wouldn't have been able to cope. Luckily that is not a thing we've seen in the time we've been mapping procedures. But one never likes to say never. And, like good scouts, we always like to be prepared.

* And, finally, the [citation](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e267) class has had a small spring clean. Wherever our maps are informed by legislation or standing orders, we make every effort to cite the relevant material. So far, those citations only live in the form of pixels on maps, there being no slot in our database to store them. This is another thing we aim to fix in the coming months.

[Work remains](https://trello.com/c/XHIeFSRO/249-expand-the-procedure-model) on reshaping our procedure model. We think we might want to introduce the ability for procedures to belong to procedures. Our current workaround involves assigning routes to more than procedure, but this approach is not what one might call efficient. And with [Anya](https://twitter.com/bitten_) standing by with her time and motion clipboard, efficiency is everything to us. 

On the subject of Anya's efficiency drive, conversations with [Silver](https://twitter.com/silveroliver) saw the recent introduction of a new [concept annotation](https://ukparliament.github.io/ontologies/utility/utility-ontology.html#d4e174) class to our [utility model](https://ukparliament.github.io/ontologies/utility/utility-ontology.html). This based loosely on the [web annotation ontology](https://www.w3.org/TR/annotation-vocab/) and designed to capture not only the relationship between a document and its subjects, but also the act of subject indexing the document, when it happened and who did it. We now think we might want to do something similar with procedure actualisations, which currently exist as a object property but which may well become a class. All this so Anya can track both time and motion in order to hand out her newly minted Librarian of the Week medals. And yes, we do know about [RDF-Star](https://w3c.github.io/rdf-star/cg-spec/editors_draft.html). We just don't like it.

## Pointing at legislation

Way, way back, well before Christmas, Librarian Jayne [posted a thread](https://twitter.com/madenlaid/status/1466395002393743362) on recent developments to both [website](https://statutoryinstruments.parliament.uk/) and [queries](https://ukparliament.github.io/ontologies/procedure/meta/queries/). Friend of the family [John](https://twitter.com/johnlsheridan) picked up on one tweet and [questioned the nature of the enabling act URI](https://twitter.com/johnlsheridan/status/1466599442870460416) we were pointing to. Why, he wondered were we pointing to the Act as it exists now - for a moving window of now - rather than the Act as enacted. This week we finally got round to replying. A short email conversation covered both the form of the URI we store and the form of the URI we should publish. Now our register of legislation URIs is used for two purposes. The first being to subject index parliamentary material. So our crack team of librarians can say, this debate, in Hansard, is about this Act in the most general terms. The second being the same crack librarians taking a statutory instrument and pointing it at its [enabling Act](https://ukparliament.github.io/ontologies/legislation/legislation-ontology.html#d4e292). Whilst the Act may be enabling, it is also not unlikely to have changed over time. Which means the [powers it may delegate](https://ukparliament.github.io/ontologies/legislation/legislation-ontology.html#d4e155) may also change over time. And the nature of the SIs it may [enable](https://ukparliament.github.io/ontologies/legislation/legislation-ontology.html#d4e181) may change likewise. 

Whilst it makes sense to store in the most generic fashion possible - there is little point in us replicating the work of [TNA](https://www.nationalarchives.gov.uk/) - we'd also like to be able to point at the Act as it existed at the time any delegated legislation was made. Which means we've decided to store the ID / work form of the URI, and amend Jayne's [SPARQL](https://en.wikipedia.org/wiki/SPARQL) query to take that URI, grab the made date of the instrument and smush together a URL to the Act at the time of making. Which we hope will satisfy everyone. Not least John and team. Our [Jianhan](https://twitter.com/jianhanzhu) has picked up the [URI migration task](https://trello.com/c/mATz3U2W/50-migrate-act-uris), our Jayne the SPARQL munging. We hope to have something to show shortly.

## Mocking questions

No further work has taken place on our [mock data for written questions and answers](https://github.com/ukparliament/ontologies/tree/master/question-and-answer/examples). Mostly because no one has asked for any. That said, Librarian Ned has dived into Parliamentary Search [in pursuit of stats](https://trello.com/c/wqyXPnKT/426-written-statment-stats-from-ned). It turns out that, of 102 [work level statements](https://ukparliament.github.io/ontologies/written-statement/written-statement-ontology.html#d4e70), 99 had an [expression](https://ukparliament.github.io/ontologies/written-statement/written-statement-ontology.html#d4e137) in each House, with only three having a single expression. And that, always in the House of Commons. Of the 99, all had identical titles, three were expressed on different dates and four were expressed by different government departments. Proof, if proof were needed, that our decision to tart up our [written statement model](https://ukparliament.github.io/ontologies/written-statement/written-statement-ontology.html) a dash of [FRBR](https://en.wikipedia.org/wiki/Functional_Requirements_for_Bibliographic_Records) was not unwise.

## Member data developments

Sometime late last year, our crack team of librarians took over management of a system called [MNIS](https://data.parliament.uk/membersdataplatform/default.aspx). Or the Members' Names Information System. Or at least the House of Commons bit of MNIS. Or at least some of the House of Commons bit of MNIS. We haven't typed much about it here because everything was new and it took a while to get appropriate - and appropriately trained - bodies in place.

This week, librarians Anna, Emily and [Phil](https://twitter.com/philbgorman) have been mostly fretting about the display of party affiliations on the website. The House of Lords had asked for a change to the display logic to no longer show a Member as being affiliated with a party - or other [parliamentary grouping](https://ukparliament.github.io/ontologies/parliamentary-bloc/parliamentary-bloc-ontology.html) - during periods in which the Member was not actually a Member. So, if an hereditary peer had left and returned as either a life peer or an [excepted hereditary](https://en.wikipedia.org/wiki/By-elections_to_the_House_of_Lords), the dates for party affiliation would span the period of first membership, the period they were elsewhere and the period of second membership. Which was less than ideal. Changes to this logic are made more difficult by the differences in the Houses. Whilst a Member of the Lords may be considered a Member, even during periods of [dissolution](https://ukparliament.github.io/ontologies/time-period/time-period-ontology.html#d4e166), this is not true of Members of the Commons. And if a person is not a Member, they cannot be [affiliated](https://ukparliament.github.io/ontologies/parliamentary-bloc/parliamentary-bloc-ontology.html#d4e160) with a [parliamentary bloc](https://ukparliament.github.io/ontologies/parliamentary-bloc/parliamentary-bloc-ontology.html#d4e149). Obviously. More patching up of 'party' affiliation dates [may be required](https://trello.com/c/Sa13QTo8/91-query-that-finds-party-affiliations-that-stretch-across-dissolutions), but we think we know the way forward.

In other MNIS news, our [query library](https://ukparliament.github.io/ontologies/meta/relational/mnis/queries/) is now fully operational and growing on a weekly basis. Access to GitHub has been granted and all librarians are now fully equipped to publish. Super stuff.

## Rush tidies

Librarian Anna has been busy tidying the [Rush data](https://membersafter1832.historyofparliamentonline.org/). [Shedcode James](https://twitter.com/jamesjefferies) has been busy normalising her efforts. Which means we now have normalised data for [trade union connection types](https://membersafter1832.historyofparliamentonline.org/trade_union_connection_types) and much tidier data for the number of seats in a constituency. Yes, some constituencies did used to return more than one Member. Odd the things you learn.




