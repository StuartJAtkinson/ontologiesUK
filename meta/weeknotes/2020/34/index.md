# 2020 - Week 34


## Career opportunities

If you're a [librarian who loves to learn](https://twitter.com/commonslibrary/status/1293141863071875073), [Anya](https://twitter.com/bitten_) is still looking. If you - or someone you know - is a keen librarian with an interest in Parliament, procedure and especially the management of data, this could well be [the job for you](https://housesofparliament.tal.net/vx/appcentre-HouseOfCommons/brand-2/candidate/so/pm/1/pl/15/opp/1750-Procedure-Data-Librarian/en-GB). You have one more week to fill in the form and come and be our new friend.

## Procedure mapping

With our [Jianhan](https://twitter.com/jianhanzhu) firmly back in the saddle, we are finally able to make progress on development work that had been paused for want of a developer. Jianhan picked up the [time bound routes card](https://trello.com/c/CDGB80DD/57-time-bound-routes) - first created by Librarian Jayne back in February - and ran with it. The routes an instrument might take through procedure vary over time. Sometimes because legislation changes, sometimes because [Standing Orders](https://www.parliament.uk/site-information/glossary/standing-orders/) change and sometimes because committee allocation changes. The [treaty procedure under the Constitutional Reform and Governance Act 2010](https://ukparliament.github.io/ontologies/procedure/flowcharts/crag-treaties/crag-treaties.pdf) is a pretty good illustration of the latter. The dotted red routes from laying before the House of Lords were closed to traffic earlier this year when the new [EU International Agreements Sub-Committee](https://committees.parliament.uk/committee/448/eu-international-agreements-subcommittee/) came into being. The solid red route to the allocation to that committee being a brand new road laid at the same time. But without time bound routes we had no means to reflect this is the data. Which means [our machine generated map](https://procedures.azurewebsites.net/Procedures/6/graph) still includes routes that are no longer traversable. So far, Jianhan has added start and end dates to the procedure database and made those editable in the application. And Librarian Jayne has mailed our friends in treaty procedure land to check what dates she needs to add. The next step is to add the ability to store start and end dates to the physical ontology in our staging environment. Then hook the procedure editor database to the [data platform](https://api.parliament.uk/), so the dates added by our crack team of librarians flow into the data proper. At which point our colleagues in Software Engineering will need to regression test the [Statutory Instrument](https://statutoryinstruments.parliament.uk/) and [treaty](https://treaties.parliament.uk/) websites to check that we haven't accidentally introduced breaking changes. And, if that all works out, we can do it all again in the live environment and tweak our map rendering to no longer show routes with an end date in the past. Or indeed a start date in the future. It's lovely having Jianhan back and extra lovely to see work we've long planned starting to happen.

Librarian Jayne and her computational expert friend and colleague [Michael](https://twitter.com/fantasticlife) continued to map out what they hope one day will be a [generic motion model](https://github.com/ukparliament/ontologies/blob/master/procedure/flowcharts/meta/motions/motion.png) for the purposes of adaptation and re-use across [all the procedure maps](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#maps). They set off on a mission to add non-fatal amendments then realised, slightly late in the day, that this would mean they'd also need to add to the decision on the main motion - to take account of decisions being on the motion as amended. So they sighed and groaned and decided to cheat. Every mention of non-fatal was updated to fatal which lessened their headaches considerably. There is still work to be done on how moving the main motion flows into the moving of any fatal amendment, and how any decision on the fatal amendment flows back into proposing and putting of the main motion. But that can wait til next week. For now both Jayne and Michael are rather pleased with progress. Though they do understand why [Erskine May may have decided to stick with writing a book](https://twitter.com/fantasticlife/status/1296032467133112321).

## Your weekly egg timer update

Robert and Michael continued to refactor and add comments to [the egg timer code](https://github.com/fantasticlife/egg-timer). The controller running the actual calculations had become bloated, containing as it did seven different flavours of calculation. You may ask how legislative drafters managed to introduce seven different ways to calculate an end date? If you do find out, we'd also love to know. But seven is what we have to deal with, and seven was making the controller code the length of a short novella. Robert and Michael learned that Ruby controller code can be modularised into things helpfully called modules. And that those modules can be required and included into the main controller. So what was one long file is now [one core controller](https://github.com/fantasticlife/egg-timer/blob/master/app/controllers/calculator_controller.rb) and [seven calculation modules](https://github.com/fantasticlife/egg-timer/tree/master/app/controllers/calculations). Which, for fans of [fag packet design](https://smethur.st/posts/176135865), is much more pleasing.

They then continued to edit comments with their usual zeal. Except this time they took their commitment to comments to a whole new level and edited them in markdown. For which Robert made [a brand new parser](https://github.com/fantasticlife/egg-timer/blob/master/lib/tasks/doc.rake). So comments for the famously [monkey patched](https://en.wikipedia.org/wiki/Monkey_patch) date class, the main controller, and the calculation for Proposed Negative Statutory Instruments are now available as HTML. Or would be if the hobby plan Heroku account we've been using hadn't run out of tokens. But, at least in theory and tokens permitting, it opens up the work we're doing to proper clerkly scrutiny. If you're at all interested in understanding how parliamentary time operates in a scrutiny sense, the date class HTML is really not the worst place to start. We'll post a link next week by which point our tokens should have stacked back up again.

Robert and Michael also took sharpened quills to the note on how to handle prorogation and dissolution that Michael scribbled last week. So that's legible now. Or would be if we had $7 a month to keep the application alive. Which is $7 dollars more than we have at this point in the month.

## All about the collaboration

Thursday saw Anya, Robert and Michael take another trip to Tothill Street where they found themselves pretty much the sole occupants of the library. The Mary Celeste vibe was still in effect, with the strong impression that [one librarian may have attempted an escape through the window](https://twitter.com/fantasticlife/status/1296396565238685696) when the order to abandon ship came. [Bryn](https://twitter.com/brynmrgn) popped by in the afternoon, Teams was fired up and [Oli](https://twitter.com/olihawkins) joined from home for a general chat about the data platform and what looks likely to be easy. And what looks likely to be hard. Michael felt a strong inclination to wheel out the [Wardley mapping](https://en.wikipedia.org/wiki/Wardley_map) but they couldn't find a board big enough. Maybe next time.






