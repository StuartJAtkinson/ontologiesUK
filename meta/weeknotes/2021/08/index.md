# 2021 - Week 8

## Money saving expert

Our [Jianhan](https://twitter.com/jianhanzhu) has been busy scratching his head about how we might save a little money on hosting costs for the data platform. It was set up to cope with the anticipated demand of the beta website, but the beta website is [no more](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/410). Early efforts to scale back [the API](https://api.parliament.uk/) did not go so well but this week he's managed to resize the triple store machines to a lower specification, thereby saving both pounds and pence. He's also been looking at our backup strategy and how we might shave some costs there. We had been backing up every couple of hours but the platform is ever growing and storing that many backups did not come for free. So this week, Jianhan has nudged the dials and we now back up once a day at 9pm. Thereby saving both taxpayer money and energy consumption in one mighty blow.

Whilst he was on the job, he also noticed that our backups were not in fact complete backups. A thing he has now fixed. And that, we thought, was that. At least until Thursday when an over eager [inverse functional property](https://www.w3.org/wiki/InverseFunctionalProperty) caused something of an [inference explosion](https://en.wikipedia.org/wiki/Principle_of_explosion) and we were forced to restore from backups. To which can only add, "phew". This led to poor Librarian Jayne spending Thursday evening re-doing all the work she'd done on Thursday afternoon. And with that, both day and data were saved. Heroes both. Applause Jayne and Jianhan.

## Enabling enabling Acts

Never one to put his feet up, Jianhan has also been beavering away on enabling enabling acts in the [procedure editor](https://trello.com/c/xegiulnz/92-staging-procedure-editor-link-a-work-package-to-an-act-or-acts), [procedure editor database](https://trello.com/c/CIBJ5WVb/97-staging-associate-all-pnsis-to-date-with-eu-withdrawal-act) and [data](https://trello.com/c/kpfT84td/85-staging-ts-ontology-changes) platform. The query to get Acts of Parliament out of SOLR and into our database has been [further polished](https://trello.com/c/UDfynPRK/99-amend-query-to-get-acts-from-solr) and the pipes from database to triple store are [flowing](https://trello.com/c/8E6YQ8mD/88-staging-orchestration-to-triple-store-import-acts-of-parliament) [freely](https://trello.com/c/Ov8hlDOr/89-staging-orchestration-to-triple-store-import-enabling-acts). We are now feature complete and only awaiting testing from our colleagues in Software Engineering. This to check we've not inadvertently broken the [statutory instrument](https://statutoryinstruments.parliament.uk/) and [treaty tracking](https://treaties.parliament.uk/) websites. Once that's done, we'll put all our code live and it's back over to Software Engineering to add the appropriate signposting and filtering to the SI website.

## Logicifying the procedure model

Jayne and [Michael][(https://twitter.com/fantasticlife)] have spent several hours of the week [remapping](https://trello.com/c/7NnUirrC/14-remap-draft-affirmative) our [draft affirmative procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/draft-affirmative.pdf) to match our newly [logical model](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html). There's not an awful lot to add here beyond pointing out that the lack of clock, the possibility of withdrawal and the House of Lords having not one but two ways to reject an instrument makes it our most logically dense map yet. [Take a look](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/logic-gates/draft-affirmative.pdf) at some of those procedure conclusion steps. It's verging on being really rather pretty.

## Map parsing

In the absense of anything more interesting to do, Michael spent most of last weekend trying to wrap his brain around our map parsing. Taking a tip from [Samu](https://twitter.com/langsamu), he's now given up on [pseudocode efforts](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/parsing/step-types/) and attempted to write some actual code. There are currently two versions: [one that starts parsing from procedural start steps](https://github.com/fantasticlife/procedure/blob/master/lib/tasks/parse-from-start-steps.rake) and works in theory but not in practice and [one that starts parsing from any business step](https://github.com/fantasticlife/procedure/blob/master/lib/tasks/parse-from-business-steps.rake) and works in practice but not in theory. Young Robert and Michael have spent a couple of hours staring at Michael's efforts but haven't yet managed to spot why the one that works in theory causes his computer to explode. It's perfectly possible there's a bug in a query somewhere and he's once more joining to a table that he's not using. Or that the code is mostly fine but his computer thinks it's in the middle of an infinte loop when it is not. How one gets Ruby code to show [a little more patience](https://github.com/fantasticlife/procedure/blob/master/config/environment.rb#L7) is a question yet to be resolved.

The version that works in practice has now been wrapped into [a web app](http://parliamentary-procedures.herokuapp.com/procedures) so if you're not a command line kinda person, [you can still see what the procedure maps suggest is allowed to happen, what's caused to happen, what can't happen yet and what can't happen now](http://parliamentary-procedures.herokuapp.com/work-packages/20/). Whilst it's all still far from perfect, it does give us some insight into where we need to tighten our logic maps, so has proved useful on some level.

We still have a problem with steps that can happen many times leading to other steps that can happen many times and [where and when we assume symmetry](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/#limitations-in-parsing-procedure-maps-symmetry-of-multiple-actualisations) in the maps. Robert and Michael have been chewing the fat about a new type of step with the working name of equals that does [some evaluation of the number of actualisations of tabling steps versus the number actualisations of withdrawal steps](https://github.com/fantasticlife/procedure/blob/master/lib/parsing/from-business-steps/equal_step.rb) and proceeds accordingly. They've even gone so far as to suggest routes might propagate numbers as well as TRUEs, FALSEs, NULLs and UNTRAVERSABLEs but at that point we would be pretty much knitting our own programming language. One is forced to wonder how Robert's plans to (re)learn Prolog are going at this point.

## Relationifying the models

Librarian [Anya](https://twitter.com/bitten_) and computational experts Robert and Michael have continued to apply what little remains of their brain capacity to converting some of our [ontological models](https://ukparliament.github.io/ontologies/) into [something more relational](https://ukparliament.github.io/ontologies/meta/relational/). If nothing else, it's an opportunity to kick tyres and look at what we've done from a slightly different angle. The accompanying [design notes](https://ukparliament.github.io/ontologies/meta/relational/) are available for anyone to comment, so if you spot something that's unclear or just plain wrong, do please dive in.

## Forming like Voltron

Friday saw the first of what will hopefully be many meetings between librarians Anya and Jayne, computational experts Jianhan, Robert and Michael, and computational expert boss bloke Ian. Talk turned toward our inference explosion, a subject that was hardly avoidable, and how we might mitigate against such things in the future. We also hatched a plan [to](http://parliamentary-procedures.herokuapp.com/procedures) [migrate](https://standing-orders.herokuapp.com/) [some](http://made-n-laid.herokuapp.com/) [of](http://tweaty-twacker.herokuapp.com/) [the](https://parliament-calendar.herokuapp.com/) [applications](http://peerages.herokuapp.com/) we currently have running on Heroku to Azure. Which, if nothing else, should save Michael Â£30 a month.



