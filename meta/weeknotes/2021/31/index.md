# 2021 - Week 31

## Work experience

Our regular reader will know that [last week](https://ukparliament.github.io/ontologies/meta/weeknotes/2021/30/) we were fortunate enough to be joined by Work Experience Singrid. And that Singrid was more than fortunate to join us. To be quite frank, so great was her excitement at last week's wander into the world of work that we were less than sure she'd turn up for more of the same. We had no wish to overwhelm her with our own enthusiasm. But turn up she did and what a treat she was in for.

## Tidying the treaty procedure

Monday saw a slow start to the week as Librarian Jayne and [Michael](https://twitter.com/fantasticlife) put the finishing touches to our [logically and arithmetically mapped treaty procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/crag-treaties/logic-gates/crag-treaties.pdf). An edge case of an edge case had occurred as they found themselves wondering what would happen if a division was [deferred](https://www.parliament.uk/site-information/glossary/deferred-divisions/) within a scrutiny period to a point in time outside the scrutiny period. A quick bout of email tennis with Mike confirmed that this was not a thing that should or could happen. So [new routes](https://trello.com/c/YL9H51ai/140-mh-pe-ma-does-the-clocks-ending-preclude-deferred-fatal-questions) were added to preclude not only questions being put but also the results of such putting outwith both periods [A](https://www.legislation.gov.uk/ukpga/2010/25/section/20#section-20-2) and [B](https://www.legislation.gov.uk/ukpga/2010/25/section/20#section-20-5).

Final preclusions in place, we were now ready to [dictate the procedure to the machines](https://trello.com/c/4y6ZiIPk/153-enter-treaty-data). Or rather, Michael was ready to dictate to Jayne who, in turn, dictated to the machines. Young Singrid sat transfixed as Michael read out AO AND to AP AND and Jayne asked AG? and Michael screamed AP and the air turned a dark shade of blue. After several hour of this, all routes were finally inside the machines and we politely enquired if the machines would be kind enough to draw it back to us. The machines thought about it, whirred a little, thought about it some more, buzzed a little, and, with some gentle coaxing, spat out [this unholy mess](https://ukparliament.github.io/ontologies/procedure/flowcharts/crag-treaties/logic-gates/crag-treaties.svg). Young Singrid finding herself in the enviable position of being one of the first three people to ever see machines attempt to draw a logically and arithmetically mapped parliamentary procedure. Wow, said Singrid. Wow, said Jayne. Wow, said Michael. Wow, [said Twitter](https://twitter.com/fantasticlife/status/1422585080900378632).

## The SI procedures strike back

Wednesday was Singrid's last day with us and we didn't want her to go away under the impression that the world of work is in any way tedious or pointless. So Jayne and Michael gave her a quick introduction to bills and Acts and delegated powers and duties and our four flavours of [statutory instrument](https://en.wikipedia.org/wiki/Statutory_instrument_(UK)) procedure. Wow, said Singrid again.

Even though we've only recently remapped the SI procedures, we've had a long standing problem with asserting what should happen in situations where the [tabling and disposal of motions may be asymmetric](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/with-route-types/#limitations-in-parsing-procedure-maps-symmetry-of-multiple-actualisations). In the past we've solved this by ignoring it and [implying some sense of symmetry that did not reflect reality](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/with-route-types/#withdrawals-preclusions-between-multiple-and-non-multiple-steps). Since our adventures in treaty map land, however, we have solved it by actually solving it. The addition of [arithmetic operators](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/with-step-types/#arithmetic-steps) to our arsenal means we can now sum the number of disposals against the number of tablings and calculate out how many cards are still on the table. So we're now [back in SI map land](https://trello.com/c/oHRtD4ru/159-redo-all-si-procedures), adding arithmetic and [signpost steps](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/with-step-types/#summation-steps) in our constant quest for Turing complete procedures. Which meant Singrid was lucky enough to see the Commons side of the [made negative procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/logic-gates/made-negative.pdf) logically and arithmetically remixed. Wow, said Singrid once more. And, can I phone my dad now? I'd like to go home.

## <sub>Signposting</sub><ins>Summationing</ins> procedures

Last week we finished adding what we had called signpost steps to the treaty procedure. By Saturday, doubts were already cast. Signpost implying an arrow pointing forwards and these steps definitely pointing back. So what were signpost steps [are now summation steps](https://trello.com/c/y92h05GS/164-update-signpost-step-to-summation-step). [Our Jianhan](https://twitter.com/jianhanzhu) has updated his handy little step checker email which now properly [counts the inputs and outputs](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/design-notes/with-step-types/#validating-inputs-and-outputs-to-steps) of our new step types, Jayne has updated both the data and all the keys on all the maps and Michael has updated both design note and [parsing code](https://api.parliament.uk/procedures/comments/summation_step.rb.html).

## On parsing and reasoning and reckoning

On the subject of parsing, Jianhan has set about adjusting our [procedure editor database](https://github.com/ukparliament/ontologies/blob/master/procedure/meta/editor/schema.pdf) to [move laying dates](https://trello.com/c/YSqaw3F6/8-ensure-laying-business-items-have-a-business-item-date) off [layings](https://ukparliament.github.io/ontologies/laying/laying-ontology.html) down to the more generic [business item](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e211). Where all the dates for other types of business item live. Which means next time [we attempt to parse a work package](https://api.parliament.uk/procedures/work-packages/9), it shouldn't say a thing that may happen is laying before the House of Lords when the instrument has already been laid in the House of Lords, been scutinised by the House of Lords and the objection period has ended.

On the same, Michael has been tinkering with our parsing application to [churn out a dot file](https://api.parliament.uk/procedures/work-packages/9/parse/log.dot) with procedural routes listed in the order they happen to be parsed. The code we've written uses a depth first traversal and - because some steps have more than one input - there are occasions on which the same route is parsed twice. Or more than twice. He wondered if it might be possible to animate a dot file to see the order of execution and the first port of call for such queries is always our good family friend, [Tony](https://twitter.com/psychemedia). A brief chat was had and before the day was out, Tony had not only animated the dot file but written a [blog post](https://blog.ouseful.info/2021/08/03/animating-graphviz-dot-files-how-parliamentary-processes-flow/) on the subject. It should probably be pointed out that the title of that post is a little incorrect. The visualisation shows the order of execution of our parsing code rather than the order of execution of procedure. Which is all together more complicated. Or complex. But if your interest is more parsing than procedure, the results are here:

<img src="https://ukparliament.github.io/ontologies/meta/weeknotes/2021/31/parse.gif" alt="Parse paths for an instrument subject to the made negative SI procedure" title="Parse paths for an instrument subject to the made negative SI procedure" />

## More on the nature of time

A [tweet from Alice](https://twitter.com/aliceolilly/status/1422256407936647179) made us wonder if we might repurpose the calendar data that sits behind our beloved [egg-timer](https://parliament-calendar.herokuapp.com/) for purposes a little more simple than [calculating scrutiny periods](https://parliament-calendar.herokuapp.com/meta/comments). The data is entered into [a set of Google calendars](https://twitter.com/madenlaid/status/1422477096090284049) by our team of crack librarians all of which are open and subscribeable. But - since we have a calendar for every flavour of day - grabbing all of them would mean five subscriptions. For this reason, Michael spent a couple of evenings making [iCalendar](https://en.wikipedia.org/wiki/ICalendar) files for [upcoming days in the House of Lords](https://parliament-calendar.herokuapp.com/houses/2/upcoming.ics) and [upcoming days in the House of Commons](https://parliament-calendar.herokuapp.com/houses/1/upcoming.ics). [Wow, once again](https://twitter.com/fantasticlife/status/1423003320982065156), said Twitter. Except Anya, who - being more bicamerally minded - said, why haven't you made one for both Houses? So that was another evening lost and we now have a [Parliament wide feed for all the upcoming days](https://parliament-calendar.herokuapp.com/houses/upcoming.ics). All three feeds are available from our [handy new calendar subscription page](https://parliament-calendar.herokuapp.com/meta/subscribe). Please fill your boots. We'd like to thank [Mark](https://twitter.com/marxculture) for chipping in with the testing and [Sym](https://twitter.com/symroe) for finally forcing Michael read the spec. And if you do ever find yourself with a spec to write, please do look at the [iCalendar one](https://www.ietf.org/rfc/rfc2445.txt) and *do something different*.

Finally, [Librarian Richard](https://twitter.com/Richard24235966) got in touch with more talk of time. He'd been looking at [section 2A of the Water Industry Act 1991](https://www.legislation.gov.uk/ukpga/1991/56/section/2A) and happened upon another example of something that looks very much like a [draft negative procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/logic-gates/draft-negative.pdf) and [another example of something that looks very like a draft negative style clock](https://www.legislation.gov.uk/ukpga/1991/56/section/2A#section-2A-8). Which made us wonder: how many pieces of legislation set out details of scrutiny pieces in a similar fashion. A quick Google [search over legislation.gov.uk reveals 19,300 results](https://www.google.com/search?q=%22during+which+Parliament+is+dissolved+or+prorogued%22+site%3Alegislation.gov.uk&biw=1220&bih=658&sxsrf=ALeKk01AujFtRQD-TE1xzDCKy3TZPaCrIw%3A1628342970637&ei=uooOYbm5JpL2gAam1rK4Bg&oq=%22during+which+Parliament+is+dissolved+or+prorogued%22+site%3Alegislation.gov.uk&gs_lcp=Cgdnd3Mtd2l6EANKBAhBGAFQm9gGWJvYBmDf3gZoAXAAeACAAUuIAYUBkgEBMpgBAKABAqABAcABAQ&sclient=gws-wiz&ved=0ahUKEwi5_tiigp_yAhUSO8AKHSarDGcQ4dUDCA4&uact=5) for documents including the phrase "during which Parliament is dissolved or prorogued" which is as good a clue as we can of. Which has now made us wonder: do drafters have mechanisms to re-use commonly applied fragments of logic. Or is it yet more of the usual copy, paste and amend. Do let us know if you know.

