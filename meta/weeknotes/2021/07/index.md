# 2021 - Week 7

## Enabling enabling Acts

Much like [week 6](https://ukparliament.github.io/ontologies/meta/weeknotes/2021/06/), week 7 saw our cast of crack librarians and computational experts continue to plod through work as if through treacle. Librarians [Anya](https://twitter.com/bitten_) and Jayne and chief printer fixer [Michael](https://twitter.com/fantasticlife) all decided enough was enough and took the opportunity to take short vacations. Alone we want you to understand. We wouldn't want the world thinking we'd upped sticks en masse to decamp to our favoured static caravan site just north of Prestatyn.

[Jianhan](https://twitter.com/jianhanzhu) alone showed the gumption and wherewithal to keep nose pressed firmly to grindstone as he continued to make magnificent progress on linking both [statutory instruments](https://en.wikipedia.org/wiki/Statutory_instrument_(UK)) and [proposed negative statutory instruments](https://www.parliament.uk/site-information/glossary/proposed-negative-statutory-instrument/) to the Acts of Parliament that enable them. Since we last spoke, he has added a couple of [new](https://trello.com/c/3pfr3hys/83-staging-new-table-enablingact) [tables](https://trello.com/c/zENbz46u/82-staging-new-table-actofparliament) and a [sprinkling of foreign keys](https://trello.com/c/M1H68gxg/84-staging-add-foreign-keys) to our procedure editor database and written a script to [pull Act details from the Search and Indexing SOLR endpoint](https://trello.com/c/cNBQ3vKk/90-staging-import-acts-of-parliament-from-search-and-indexing-solr-to-staging-database). There is still work to do to [tidy what we store in Search and Indexing](https://trello.com/c/YaG2NXxQ/91-which-legislationgovuk-urls-are-we-putting-in-solr), [build an interface to associate (PN)SIs with Acts](https://trello.com/c/xegiulnz/92-staging-procedure-editor-link-a-work-package-to-an-act-or-acts), [update our ontology](https://trello.com/c/kpfT84td/85-staging-ts-ontology-changes) and slurp both [Acts](https://trello.com/c/8E6YQ8mD/88-staging-orchestration-import-acts-of-parliament) and their [enablings](https://trello.com/c/Ov8hlDOr/89-staging-orchestration-import-enabling-acts) into the data platform. But we are well on our way to being able to differentiate instruments by the Acts that enable them on the [SI website](https://statutoryinstruments.parliament.uk/). Which we hope will keep JO Jane sweet for a while.

We've also been wondering if we might save a little librarian effort and hit the data representations on [legislation.gov.uk](https://www.legislation.gov.uk/) with URIs for SIs in the hope we'll get back a ready made array of enabling Acts. Because Michael is congenitally lazy he has followed up this thought by by-passing any investigation and [tweeting](https://twitter.com/fantasticlife/status/1363129509302718466) [John](https://twitter.com/johnlsheridan) and [Catherine](https://twitter.com/CathTabone). Tune in next week if you're eager to know the answer.

## Logicifying the procedure model

We are happy report that the [fully logicified draft negative SI procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/logic-gates/draft-negative.pdf) is now [inside the machines](https://trello.com/c/FqYcItxC/19-enter-draft-negative-routes-to-staging). So far the machines have neither choked nor vomited and have even been good enough to [draw us a picture of the resulting mess](https://ukparliament.github.io/ontologies/meta/weeknotes/2021/06/draft-negative.png). Which is nice. Whilst week 6 was all about fighting back boredom as Librarian Jayne and Michael entered the data, week 7 upped the tedium as they spent several hours checking it all. It is now checked. They are happy. Job done.

In the course of checking they realised that they'd missed off adding self preclusions to both the 'instrument cannot become law' and the 'instrument comes into force as law steps'. And in a similar fashion had forgotten to do the same for the 'Instrument stops being law' and the 'instrument remains law' steps in its close cousin, the [made negative procedure](https://ukparliament.github.io/ontologies/procedure/flowcharts/sis/logic-gates/made-negative.pdf). Self preclusion being the thing that tells the machines that this thing having happened, it cannot happen again. And things like not being able to become law, coming into force as law, stopping being law and remaining law all fall firmly into the "can't really happen again" camp. So a handful of new routes, tying together a smattering of AND and NOT steps, have been added and [that problem is fixed](https://trello.com/c/7LiOASlg/96-add-self-preclusion-to-stops-being-law-in-made-neg).

## Map parsing

On the subject of telling the machines what to do, Michael has been busying himself try to stretch his limited brain around how the parsing code should work. So far with only limited success. Taking a tip from [Samu](https://twitter.com/langsamu), he decided to put away the [pseudocode](https://ukparliament.github.io/ontologies/procedure/flowcharts/meta/parsing/step-types/) as a child puts away toys. Instead adopting the more grown up approach of trying his hand at actual code. [SQL Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server) to [Postgres](https://en.wikipedia.org/wiki/PostgreSQL) migration not being a tool we have at our disposal, Jianhan kindly exported CSV files of the [procedure editor staging database](https://github.com/ukparliament/ontologies/blob/master/procedure/meta/editor/schema.pdf) and Michael set about loading them into his favoured, freer database. [Free as in open](https://en.wikipedia.org/wiki/Gratis_versus_libre) here. Not beer. At this point the import exploded. Young Robert jumped in to lend a hand but even his considerable synaptic aptitude could not help. So Michael took his usual approach of [whining on Twitter](https://twitter.com/fantasticlife/status/1361313072833527808) and [James](https://twitter.com/jamesjefferies) came riding to the rescue. That very eve he reported back with [full and frank observations](https://twitter.com/jamesjefferies/status/1361426981045346305). Microsoft being Microsoft embed a [BOM](https://en.wikipedia.org/wiki/Byte_order_mark) in CSV exports from SQL Server. And BOMs being BOMs, they tend to explode. All easy enough to fix but one does wonder about the utility of adding invisible characters as a means of helping anything. Nevertheless, thanks James.

Ambition undiminished, Michael set about attempting to write some [Rails code to parse a work package](https://github.com/fantasticlife/procedure/blob/master/app/controllers/work_package_controller.rb#L22) in the context of a parliamentary procedure. Again taking a tip from Samu - and finding himself at gunpoint from Anya's requirement to distinguish the not yet possible from the not now possible - he stepped away from the brute force option of parsing routes in any order and instead started at the start. And worked downwards. In some clumsy approximation of a [depth first graph traversal](https://en.wikipedia.org/wiki/Depth-first_search). Things were going swimmingly until he added multiple parsing across the outputs of AND and OR steps. At which point the whole thing exploded again.

Face blackened, Michael persevered and switched his efforts from a Rails web app to a [rake task](https://github.com/fantasticlife/procedure/blob/master/lib/tasks/parse.rake). Which uncovered a bug in one of his queries that made the schoolboy error of joining to a table that he didn't use. Oops. Another bug squashed, he rewrote the step parsing code, spent quite some time on comments and pressed the parse button. Only to watch in horror as the machine made 2466 attempts to parse 466 routes. And [exploded](https://twitter.com/fantasticlife/status/1363080947340611584). The "code", if one can call it that, [is here](https://github.com/fantasticlife/procedure). It's currently in more pieces than a Lego set on a child's bedroom floor. Make of it what you will.

## Procedure mapping

This week's only other venture into procedure mapping was one of those happy moments where the correct answer turns out to be 'do nothing'. Back in December, Librarian Emma spotted that the [Economic Affairs Committee](https://committees.parliament.uk/committee/175/economic-affairs-committee/) were planning to report on the [Social Security Contributions (Intermediaries) (Miscellaneous Amendments) Regulations 2020](https://statutoryinstruments.parliament.uk/timeline/nYBsCLnw/SI-20201220/). At the time we weren't sure whether this was part of the scrutiny procedure that we should try to map, or the parliamentary equivalent of a [botanical sport](https://en.wikipedia.org/wiki/Sport_(botany)). Upon further investigation, the report turned out to be focused on an aspect of policy included in the SI that was known by all parties to be 'defective'. And that the Government had already made a written ministerial statement shortly after the SI was laid to say that the they'd have to make a technical change to the SI using the next Finance Bill before the SI comes into force in April 2021. So all agreed the report was not in fact part of any formal proceedings and [our maps remain unchanged](https://trello.com/c/E8YgOzZL/329-jw-economic-affairs-committee-report).

## All about the collaboration

On Monday, Librarians Anya, Liz and Ned and computational experts Robert and Michael were joined in pixels by the aforementioned Catherine and [Simon](https://twitter.com/Tagishsimon) to chat all things SI and Wikidata related. Catherine has promised to look into whether [TNA](https://www.nationalarchives.gov.uk/) might pick up the work currently done by Simon's screen scraper and push all new SIs directly into Wikidata. We also hatched a plan to retire the current [Mix'n'Match](https://mix-n-match.toolforge.org/#/catalog/1229), import the Wikidata IDs of all matched concepts into our thesauri, export a new list of concepts yet to be matched and set up a brand new Mix'n'Match to do just that. Thanks for your time Catherine and Simon.

## In continuence of our limited education

On Thursday, Anya, Jayne, Robert and Michael took up [Luke](https://twitter.com/Lenorbury)'s kind offer of an introduction to statutory interpretation for dunces. Many things were learnt. Particularly around the scope of definitions. Luke was also kind enough to dip into a couple of our questions around whether Parliament is precluded from acting before the scrutiny clock kicks off and whether a PNSI is in fact just a manifestation of an SI. There is always the feeling that some questions are unanswerable until a judge passes judgement and we accept it is bad form to take one's employer to court just to get to the bottom of an if / else statement. Especially when your employer is Parliament. Sometimes on has to accept that there are known unknowns and live with the fact. Thanks Luke. We may well be back with further noddy questions.