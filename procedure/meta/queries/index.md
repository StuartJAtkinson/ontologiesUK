# Some handy [SPARQL](https://en.wikipedia.org/wiki/SPARQL) queries

Given [accurate maps of procedures](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#flowcharts) and enough instance data of things subject to those procedures, we can start to treat precedence as a thing we can query for.

This is a list of SPARQL queries used by the House of Commons Library to check and report on their work. Feedback and requests always welcome. Please email [RIIDMSMailbox@parliament.uk](mailto:RIIDMSMailbox@parliament.uk).

## Queries for 'currentness'

These three queries will help you establish which [work packages](https://ukparliament.github.io/ontologies/procedure/procedure-ontology.html#d4e259) have reached their end date. The search results will show all 'current' workpackages, you can search for your date or show by most recent date. Or alternatively you can add an additional string to your query to search by specific date (note you have to add +1 to your date):
 
FILTER ( str(?itemDate) <= '2020-02-06')
 
Copy and paste the following url links into your browsers.
 
* [Negative SIs](https://api.parliament.uk/sparql#query=PREFIX+rdfs%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0APREFIX+%3A+%3Chttps%3A%2F%2Fid.parliament.uk%2Fschema%2F%3E%0Aselect+%3FSI+%3FSIname+%3FworkPackage+%3Fproc+%3FprocStepName+%3FitemDate+where+%7B%0A+%3FSI+a+%3AStatutoryInstrumentPaper+.++%0A+++++%3FSI+rdfs%3Alabel+%3FSIname+.%0A%09%3FSI+%3AworkPackagedThingHasWorkPackage+%3FworkPackage+.%0A++%09%3FworkPackage+%3AworkPackageHasProcedure%2Frdfs%3Alabel+%3Fproc%0A++FILTER(%3Fproc+IN+(%22Made+negative%22%2C+%22Draft+negative%22))%0A++%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem+.%0A++%3FbusItem+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate2%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate+.%0A++%3FprocStep+rdfs%3Alabel+%3FprocStepName.%0A++MINUS%7B%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep2+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem2+.%0A++%3FbusItem2+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate3%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate1+.%0A++++%3FprocStep2+rdfs%3Alabel+%3FprocStepName2+.+%0A++FILTER(%3FprocStepName2+IN+(%22Procedure+concluded+in+the+House+of+Commons+and+the+House+of+Lords%22%2C+%22Procedure+concluded+in+the+House+of+Commons%22))%0A++++FILTER(%3FitemDate3+IN+(%22Procedure+concluded+in+the+House+of+Commons+and+the+House+of+Lords%22%2C+%22Procedure+concluded+in+the+House+of+Commons%22))%0A++++%0A++%7D%0A++FILTER(%3FprocStepName+IN+(%22Objection+period+ends%22))%0A++FILTER(%3FitemDate2+IN+(%22Objection+period+ends%22))%0A++%0A+++%0A%7D%0A&contentTypeConstruct=text%2Fturtle&contentTypeSelect=application%2Fsparql-results%2Bjson&endpoint=https%3A%2F%2Fapi.parliament.uk%2Fsparql&requestMethod=POST&tabTitle=Negative+-+objection+period+end&headers=%7B%7D&outputFormat=table)
 
* [Made affirmative SIs](https://api.parliament.uk/sparql#query=PREFIX+rdfs%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0APREFIX+%3A+%3Chttps%3A%2F%2Fid.parliament.uk%2Fschema%2F%3E%0Aselect+%3FSI+%3FSIname+%3FworkPackage+%3Fproc+%3FprocStepName+%3FitemDate+where+%7B%0A+%3FSI+a+%3AStatutoryInstrumentPaper+.++%0A+++++%3FSI+rdfs%3Alabel+%3FSIname+.%0A%09%3FSI+%3AworkPackagedThingHasWorkPackage+%3FworkPackage+.%0A++%09%3FworkPackage+%3AworkPackageHasProcedure%2Frdfs%3Alabel+%3Fproc%0A++FILTER(%3Fproc+IN+(%22Made+affirmative%22))%0A++%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem+.%0A++%3FbusItem+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate2%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate+.%0A++%3FprocStep+rdfs%3Alabel+%3FprocStepName.%0A++MINUS%7B%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep2+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem2+.%0A++%3FbusItem2+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate3%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate1+.%0A++++%3FprocStep2+rdfs%3Alabel+%3FprocStepName2+.+%0A++FILTER(%3FprocStepName2+IN+(%22Procedure+concluded+in+the+House+of+Commons+and+the+House+of+Lords%22%2C+%22Procedure+concluded+in+the+House+of+Commons%22))%0A++++FILTER(%3FitemDate3+IN+(%22Procedure+concluded+in+the+House+of+Commons+and+the+House+of+Lords%22%2C+%22Procedure+concluded+in+the+House+of+Commons%22))%0A++++%0A++%7D%0A++FILTER(%3FprocStepName+IN+(%22Approval+period+ends%22))%0A++FILTER(%3FitemDate2+IN+(%22Approval+period+ends%22))%0A++%0A+++%0A%7D%0A&contentTypeConstruct=text%2Fturtle&contentTypeSelect=application%2Fsparql-results%2Bjson&endpoint=https%3A%2F%2Fapi.parliament.uk%2Fsparql&requestMethod=POST&tabTitle=Query&headers=%7B%7D&outputFormat=table)
 
* [Treaties](https://api.parliament.uk/sparql#query=PREFIX+rdfs%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0APREFIX+%3A+%3Chttps%3A%2F%2Fid.parliament.uk%2Fschema%2F%3E%0Aselect+%3FTreaty+%3FTreatyname+%3FLeadOrg+%3FSeriesmembership+%3FworkPackage+%3FprocStepName+%3FitemDate+where+%7B%0A+%3FTreaty+a+%3ATreaty+.++%0A+++++%3FTreaty+rdfs%3Alabel+%3FTreatyname+.%0A++OPTIONAL%7B+%3FTreaty+%3AtreatyHasLeadGovernmentOrganisation%2F+rdfs%3Alabel+%3FLeadOrg+.%7D+%0A++OPTIONAL+%7B%3FTreaty+%3AtreatyHasSeriesMembership%2F+%3AseriesItemCitation+%3FSeriesmembership.%7D%0A%09%3FTreaty+%3AworkPackagedThingHasWorkPackage+%3FworkPackage+.%0A++%09%3FworkPackage+%3AworkPackageHasProcedure%2Frdfs%3Alabel+%3Fproc%0A++FILTER(%3Fproc+IN+(%22Treaties+subject+to+the+Constitutional+Reform+and+Governance+Act+2010%22))%0A++%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem+.%0A++%3FbusItem+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate2%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate+.%0A++%3FprocStep+rdfs%3Alabel+%3FprocStepName.%0A+++MINUS%7B%3FworkPackage+%3AworkPackageHasBusinessItem%2F%3AbusinessItemHasProcedureStep+%3FprocStep2+%3B%0A+++++++++++%3AworkPackageHasBusinessItem+%3FbusItem2+.%0A++%3FbusItem2+%3AbusinessItemHasProcedureStep%2Frdfs%3Alabel+%3FitemDate3%3B%0A+++++++++++%3AbusinessItemDate+%3FitemDate1+.%0A++++%3FprocStep2+rdfs%3Alabel+%3FprocStepName2+.+%0A++++FILTER(%3FprocStepName2+IN+(%22Parliamentary+procedure+concluded%2C+government+cannot+ratify+treaty%22%2C+%22Parliamentary+procedure+concluded%2C+government+can+ratify+treaty%22))%0A++++FILTER(%3FitemDate3+IN+(%22Parliamentary+procedure+concluded%2C+government+cannot+ratify+treaty%22%2C+%22Parliamentary+procedure+concluded%2C+government+can+ratify+treaty%22))++%0A++%7D%0A++FILTER(%3FprocStepName+IN+(%22Objection+period+A+ends%22))%0A++FILTER(%3FitemDate2+IN+(%22Objection+period+A+ends%22))%0A+++%7D%0A&contentTypeConstruct=text%2Fturtle&contentTypeSelect=application%2Fsparql-results%2Bjson&endpoint=https%3A%2F%2Fapi.parliament.uk%2Fsparql&requestMethod=POST&tabTitle=Query&headers=%7B%7D&outputFormat=table)